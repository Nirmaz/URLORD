
True cuda
args: None ULord ULord_2 /cs/casmip/nirm/embryo_project_version1/EXP_FOLDER/exp_fp2/194/exp2d_DF_3_2d True ulord2d_194exp2d_DF_3_2d DF_3_2d_TL DF_3_2d_TU DF_3_2d_VA DF_3_2d_TE False True /cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/models_config/config_2d /cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/models_config/config_2d
dividing....
(2016, 128, 128, 1) imaggggggeeeeeeeeeeeeeeee shape
[0.] unique claseesssssssssssssssssssssssssssssssssssssssssssssssss
False False load_model
arrive train
2 30 config['n_classes'], config['class_dim']
here seg decay
here recon_loss
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/modules_unet.py:356: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(x, requires_grad = False)
  0% 0/378 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
------------ 0.5013816356658936 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15156221389770508 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1520099639892578 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.14983224868774414 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15321612358093262 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.150285005569458 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15338468551635742 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15075087547302246 backwards -------------------------------
1 recon_decay
epoch #0:   2% 8/378 [00:02<01:35,  3.87it/s, loss=4.5]
  2% 8/378 [00:02<01:35,  3.87it/s]
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15534424781799316 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15120244026184082 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15073657035827637 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15069079399108887 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.150773286819458 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15089178085327148 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15270233154296875 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15390896797180176 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss

  4% 16/378 [00:04<01:24,  4.26it/s]
------------ 0.1527094841003418 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.19472122192382812 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.16776084899902344 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.17809486389160156 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.16452622413635254 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.18129658699035645 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1527693271636963 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15209007263183594 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss

  6% 24/378 [00:06<01:28,  4.01it/s]
------------ 0.151353120803833 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15282964706420898 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1520402431488037 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15216636657714844 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15085768699645996 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15285825729370117 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15108633041381836 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15090513229370117 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15124273300170898 backwards -------------------------------

  9% 33/378 [00:08<01:20,  4.28it/s]
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1519310474395752 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15282487869262695 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15234041213989258 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.16003012657165527 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.18396711349487305 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15267705917358398 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.18013310432434082 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1573493480682373 backwards -------------------------------

 11% 41/378 [00:10<01:25,  3.96it/s]
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1511533260345459 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15191936492919922 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15428805351257324 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1522989273071289 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15172934532165527 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15377092361450195 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15291953086853027 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15388703346252441 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss

 13% 49/378 [00:12<01:17,  4.26it/s]
------------ 0.15333008766174316 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15398383140563965 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15492486953735352 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15345549583435059 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1537485122680664 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15520787239074707 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1537637710571289 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.17679238319396973 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15712714195251465 backwards -------------------------------

  File "/cs/casmip/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_exp.py", line 140, in <module>
    main()
  File "/cs/casmip/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_exp.py", line 133, in main
    args.func(args)
  File "/cs/casmip/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_exp.py", line 114, in run_exp
    train_model(model_dict, path_new_exp, model_name, exp_dict['data_l_name'], exp_dict['data_u_name'], exp_dict['data_v_name'], exp_dict['data_t_name'], exp_dict['base_dir'])
  File "/cs/casmip/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_exp.py", line 31, in train_model
    take_from_arg = False)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_unet.py", line 367, in train_ulord
    loaded_model=load_model
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 420, in train
    segs_t, classes_t, model_dir, tensorboard_dir, loaded_model, dim)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 533, in train_ULordModel
    self.training_model(model_dir, tensorboard_dir)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 695, in training_model
    reco_loss_epoch, reco_loss_epoch_witha, i)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 378, in do_step_ulord
    loss.backward()
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/autograd/__init__.py", line 149, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1528608798980713 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1536865234375 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15358185768127441 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.15294480323791504 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.1528465747833252 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss