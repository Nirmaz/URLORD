True cuda
args: None URLord URLord_2 /cs/casmip/nirm/embryo_project_version1/EXP_FOLDER/exp_fp2/207/exp2d_DF_3_2d True urlord2d_207exp2d_DF_3_2d DF_3_2d_TL DF_3_2d_TU DF_3_2d_VA DF_3_2d_TE False True /cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/models_config/config_2d /cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/models_config/config_2d
dividing....
(2016, 128, 128, 1) imaggggggeeeeeeeeeeeeeeee shape
[0.] unique claseesssssssssssssssssssssssssssssssssssssssssssssssss
False False load_model
arrive train
2 30 config['n_classes'], config['class_dim']
here seg decay
here recon_loss
/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/modules_unet.py:356: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(x, requires_grad = False)
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.05050468444824219 loss -------------------------------
------------ 0.17064595222473145 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.042359113693237305 loss -------------------------------
------------ 0.15198373794555664 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03914308547973633 loss -------------------------------
------------ 0.1518855094909668 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.04162168502807617 loss -------------------------------
------------ 0.15185213088989258 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.04162287712097168 loss -------------------------------
  0%|                                                                                                                                                                                                                                                                                        | 0/378 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)                                                                                                                                                                                             | 0/378 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)                                                                                                                                                                                              | 0/45 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)                                                                                                                                                                                             | 0/126 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
epoch #0:   1%|██▋                                                                                                                                                                                                                                                        | 4/378 [00:01<02:00,  3.10it/s, loss=3.57]
  1%|██▉                                                                                                                                                                                                                                                                             | 4/378 [00:01<02:00,  3.10it/s]
------------ 0.1515214443206787 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.039672136306762695 loss -------------------------------
------------ 0.1522233486175537 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03889775276184082 loss -------------------------------
------------ 0.15215277671813965 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03957056999206543 loss -------------------------------
------------ 0.1524033546447754 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.04119420051574707 loss -------------------------------
------------ 0.155012845993042 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03971743583679199 loss -------------------------------
------------ 0.15262341499328613 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03940987586975098 loss -------------------------------
------------ 0.15162229537963867 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03929948806762695 loss -------------------------------
------------ 0.15384888648986816 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03921842575073242 loss -------------------------------
------------ 0.15244030952453613 backwards -------------------------------
  File "lord_exp.py", line 140, in <module>                                                                                                                                                                                                                                         | 13/378 [00:03<01:29,  4.09it/s]
    main()
  File "lord_exp.py", line 133, in main
    args.func(args)
  File "lord_exp.py", line 114, in run_exp
    train_model(model_dict, path_new_exp, model_name, exp_dict['data_l_name'], exp_dict['data_u_name'], exp_dict['data_v_name'], exp_dict['data_t_name'], exp_dict['base_dir'])
  File "lord_exp.py", line 31, in train_model
    take_from_arg = False)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_unet.py", line 367, in train_ulord
    loaded_model=load_model
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 434, in train
    segs_t, classes_t, model_dir, tensorboard_dir, loaded_model, dim)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 529, in train_URLordModel
    self.training_model(model_dir, tensorboard_dir)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 706, in training_model
    reco_loss_epoch, reco_loss_epoch_witha, i)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 375, in do_step_ulord
    batch_u['img'], batch_u['class_id'])
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/modules_unet.py", line 269, in forward
    anatomy_img = self.generator_antomy(img)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/unet2d_model.py", line 400, in forward
    x, before_pooling = module(x)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/unet2d_model.py", line 193, in forward
    y = self.act2(y)  # activation 2
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/functional.py", line 1298, in relu
    result = torch.relu(input)
KeyboardInterrupt