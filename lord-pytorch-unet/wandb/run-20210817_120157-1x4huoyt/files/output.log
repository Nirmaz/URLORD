True cuda
args: None URLord URLord_2 /cs/casmip/nirm/embryo_project_version1/EXP_FOLDER/exp_fp2/210/exp2d_DF_3_2d True urlord2d_210exp2d_DF_3_2d DF_3_2d_TL DF_3_2d_TU DF_3_2d_VA DF_3_2d_TE False True /cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/models_config/config_2d /cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/models_config/config_2d
dividing....
(2016, 128, 128, 1) imaggggggeeeeeeeeeeeeeeee shape
[0.] unique claseesssssssssssssssssssssssssssssssssssssssssssssssss
False False load_model
arrive train
2 30 config['n_classes'], config['class_dim']
/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/modules_unet.py:356: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(x, requires_grad = False)
here seg decay
here recon_loss
  0%|                                                                                                                                                                                                                                                                                        | 0/378 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)                                                                                                                                                                                             | 0/378 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)                                                                                                                                                                                              | 0/45 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)                                                                                                                                                                                             | 0/126 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
epoch #0:   1%|██▋                                                                                                                                                                                                                                                         | 4/378 [00:01<01:59,  3.13it/s, loss=3.8]
  1%|██▉                                                                                                                                                                                                                                                                             | 4/378 [00:01<01:59,  3.13it/s]
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.04753303527832031 loss -------------------------------
------------ 0.16931462287902832 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.0406031608581543 loss -------------------------------
------------ 0.1500692367553711 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.038585662841796875 loss -------------------------------
------------ 0.14994168281555176 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.038768768310546875 loss -------------------------------
------------ 0.14998435974121094 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
  File "lord_exp.py", line 140, in <module>                                                                                                                                                                                                                                         | 13/378 [00:03<01:27,  4.15it/s]
    main()
  File "lord_exp.py", line 133, in main
    args.func(args)
  File "lord_exp.py", line 114, in run_exp
    train_model(model_dict, path_new_exp, model_name, exp_dict['data_l_name'], exp_dict['data_u_name'], exp_dict['data_v_name'], exp_dict['data_t_name'], exp_dict['base_dir'])
  File "lord_exp.py", line 31, in train_model
    take_from_arg = False)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/lord_unet.py", line 367, in train_ulord
    loaded_model=load_model
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 434, in train
    segs_t, classes_t, model_dir, tensorboard_dir, loaded_model, dim)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 529, in train_URLordModel
    self.training_model(model_dir, tensorboard_dir)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 706, in training_model
    reco_loss_epoch, reco_loss_epoch_witha, i)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 381, in do_step_ulord
    reco_loss_l, reco_loss_u = self.calc_rec_loss(out, batch_t, batch_u, criterion)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/training_unet.py", line 313, in calc_rec_loss_urord
    reco_loss_u = criterion(out['img_u'], batch_u['img'] * seg1, None)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/modules_unet.py", line 583, in forward
    f1 = self.vgg(I1)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/labs/josko/nirm/embryo_project_version1/embyo_projects_codes/lord-pytorch-unet/model/modules_unet.py", line 563, in forward
    x = self.vggnet.features[i](x)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/cs/casmip/nirm/embryo_project_version1/venu-pytorch/lib/python3.7/site-packages/torch/nn/functional.py", line 1296, in relu
    result = torch.relu_(input)
KeyboardInterrupt
------------ 0.14998459815979004 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.038316965103149414 loss -------------------------------
------------ 0.15070199966430664 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03836560249328613 loss -------------------------------
------------ 0.14998459815979004 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.0377802848815918 loss -------------------------------
------------ 0.1503145694732666 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.038318634033203125 loss -------------------------------
------------ 0.15005278587341309 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.04212164878845215 loss -------------------------------
------------ 0.14910292625427246 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03815126419067383 loss -------------------------------
------------ 0.15049338340759277 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.04066157341003418 loss -------------------------------
------------ 0.1508193016052246 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss
torch.Size([16]) losssss
------------ 0.03889203071594238 loss -------------------------------
------------ 0.1524951457977295 backwards -------------------------------
1 recon_decay
torch.Size([16]) losssss